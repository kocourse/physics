<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Convex Air-Glass Interface Refraction</title>
<script src="https://cdn.jsdelivr.net/npm/p5@1.9.0/lib/p5.min.js"></script>
</head>
<body>
<h2>Convex Air-Glass Interface Refraction</h2>
<p>Enter the object distance in air (cm). Black = object, Red = image in glass.</p>
<input type="number" id="objInput" value="15" min="5" max="35" step="0.1"> cm

<script>
let objY = 200;
let n1 = 1.0;  // air
let n2 = 1.5;  // glass
let R_cm = 20;   // convex radius in cm
let scale_cm = 0.05; // 1 px = 0.05 cm
let R_px = R_cm / scale_cm; // convert to pixels
let lensX, lensY;

let objDistance_cm = 15; // default object distance

function setup() {
  createCanvas(800, 400);
  lensX = width/2;
  lensY = height/2;

  // Input box event
  let input = document.getElementById('objInput');
  input.addEventListener('input', () => {
    let val = parseFloat(input.value);
    if (!isNaN(val)) {
      objDistance_cm = val;
    }
  });

  textSize(16);
  textAlign(LEFT, CENTER);
}

function draw() {
  background(255);

  // Draw convex interface (semi-circle)
  stroke(0,0,255);
  strokeWeight(2);
  noFill();
  beginShape();
  for(let y=lensY-100; y<=lensY+100; y+=1){
    let xOffset = Math.sqrt(R_px*R_px - (y-lensY)*(y-lensY));
    vertex(lensX - xOffset, y);
  }
  endShape();

  // Object position in pixels
  let objX = lensX - objDistance_cm / scale_cm;
  drawArrow(objX, objY, 40, 'black');

  // Convert distance to pixels for calculation
  let s = objDistance_cm / scale_cm;
  let s_prime = n2 / ((n2-n1)/R_px - n1/s);

  // Image position in glass
  let imgX = lensX + s_prime;
  drawArrow(imgX, objY, s_prime>0? 40:-40, 'red');

  // Draw rays
  stroke(150,150,150);
  line(objX, objY, lensX, objY); // incident
  line(lensX, objY, imgX, objY); // refracted

  // Display numbers in cm
  noStroke();
  fill(0);
  text(`R (curve radius) = ${R_cm.toFixed(1)} cm`, 10, 20);
  text(`Object distance s = ${objDistance_cm.toFixed(1)} cm`, 10, 40);
  text(`Image distance s' = ${(s_prime*scale_cm).toFixed(1)} cm`, 10, 60);
}

function drawArrow(x, y, h, col){
  stroke(col);
  fill(col);
  line(x, y, x, y - h);
  triangle(x-5, y-h, x+5, y-h, x, y-h-10);
}
</script>
</body>
</html>
